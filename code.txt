made changes because old code was terrible
